# 타입 변환과 단축 평가

자바스크립트이 모든 값은 타입이 있다. 개발자에 의해 의도적으로 값의 타입을 변환하는 것을 명시적 타입 변환 또는 타입 캐스팅이라고 한다.

동적 타입 언어인 자바스크립트는 개발자의 의도와는 상관없이 자바스크립트 엔진에 의해 암묵적으로 타입이 자동 변환되기도 한다. 이를 암묵적 타입 변환 또는 타입 강제 변환이라고 한다.

### 1. 암묵적 타입 변환

자바스크립트 엔진은 표현식을 평가할 때 컨텍스트에 고려하여 암묵적 타입 변환을 실행한다.

암묵적 타입 변환은 변수 값을 재할당해서 변경하는 것이 아니라 자바스크립트 엔진이 표현식을 에러없이 평가하기 위해 기존 값을 바탕으로 새로운 타입의 값을 만들어 단 한번 사용하고 버린다. 표현식의 평가가 끝나면 아무도 참조하지 않으므로 가바지 컬렉터에 의해 메모리에서 제거된다.

#### 1-1. 문자열 타입으로 변환

`+` 연산자는 피연산자 중 하나 이상이 문자열이면 문자열 연결 연산자로 작동한다. 이 외에도 템플릿 리터럴의 문자열 인터폴레이션은 표현식의 평가 결과를 문자열 타입으로 암묵적 타입 변환한다.

#### 1-2. 숫자 타입으로 변환

`-`, `*`, `/`, `>`의 산술, 비교 연산자는 피연산자 중에서 숫자 타입이 아닌 피연산자를 숫자 타입으로 암묵적 타입 변환한다.

```
1 - "1";    // 0
1 * "10";   // 10
1 / "one";  // NaN
"1" > 0;    // true
```

`+`단항 연산자는 피연산자가 숫자 타입의 값이 아니면 숫자 타입의 값으로 암묵적 타입 변환을 수행한다.

```
+''         // 0
+'0'        // 0
+'1'        // 1
+'string'   // NaN
+true       // 1
+null       // 0
+undefined  // NaN
```

#### 1-3. 불리언 타입으로 변환

자바스크립트 엔진은 제어문의 조건식 평과 결과를 불리언 타입으로 암묵적 타입 변환한다.

아래 값들은 제어문의 조건식과 같이 불리언 값으로 평가되어야 할 컨텍스트에서 false로 평가되는 Falsy 값(거짓으로 인식할 값)이다.

- false
- undefined
- null
- 0, -0
- NaN
- '' (빈 문자열)

### 2. 명시적 타입 변환

개발자가 의도에 의해 명시적으로 타입을 변경하는 방법은 아래와 같다.

1. 문자열 타입으로 변환
   1-1. String 생성자 함수 (new 없이)
   1-2. toString 메소드
   1-3. 문자열 연결 연산자 `1 + ''`
2. 숫자 타입으로 변환
   2-1. Number 생성자 함수 (new 없이)
   2-2. parseInt, parseFloat 함수 사용
   2-3. 단항 연결 연산자 `+'0'`
   2-4. 산술 연산자 `'0' * 1`
3. 불리언 타입으로 변환
   3-1. Boolean 생성자 함수 (new 없이)
   3-2. !부정 논리 연산자를 두번 사용 `!!undefined`

### 3. 단축 평가

단축 평가는 `&&`, `||`, `??` 같은 논리 연산자가 왼쪽 피연산자만 보고도 전체 결과가 확정되면 오른쪽을 아예 평가하지 않는 성질을 말한다.

- `A && B`: A가 falsy라면 결과는 무조건 A → B는 실행하지 않음 (A가 truthy라면 B를 실행하고 그 값을 반환)
- `A || B`: A가 truthy라면 결과는 무조건 A → B는 실행하지 않음 (A가 falsy라면 B를 실행하고 그 값을 반환)
- `A ?? B`: A가 null 또는 undefined가 아니면 결과는 A → B는 실행하지 않음 (반대라면 B를 실행해서 B 결과를 반환)

```javascript
"Cat" || "Dog"; // 'Cat'
false || "Dog"; // 'Dog'
"Cat" || false; // 'Cat'

"Cat" && "Dog"; // 'Dog'
false && "Dog"; // false
"Cat" && false; // false

null ?? "Dog"; // 'Dog'
undefailt ?? "Dog"; // 'Dog'
"Cat" ?? "Dog"; // 'Cat'
```

단축 평가는 아래와 같은 상황에서 유용하게 사용된다.

```javascript
// isLoggedIn이 trued일때만 showUserMenu() 실행
isLoggedIn && showUserMenu();

// userInput이 falsy이면 "Guest"로 대체
let name = userInput || "Guest";

// 참조 에러를 피하기 위한 방법
let elem = null;
console.log(elem.value); // Error
console.log(elem && elem.value); // null
```
